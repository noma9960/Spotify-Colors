{"version":3,"file":"index.js","sources":["../src/Scopes.js","../src/generateUrl.js","../src/SpotifyLogo.jsx","../src/getHash.js","../src/SpotifyAuth.jsx","../src/SpotifyAuthListener.jsx","../src/index.js"],"sourcesContent":["/**\n * List of all Spotify Scopes\n */\nconst scopes = {\n  // images\n  ugcImageUpload: 'ugc-image-upload',\n\n  // follow\n  userFollowRead: 'user-follow-read',\n  userFollowModify: 'user-follow-modify',\n\n  // listening history\n  userReadRecentlyPlayed: 'user-read-recently-played',\n  userTopRead: 'user-top-read',\n  userReadPlaybackPosition: 'user-read-playback-position',\n\n  // library\n  userLibraryRead: 'user-library-read',\n  userLibraryModify: 'user-library-modify',\n\n  // spotify connect\n  userReadPlaybackState: 'user-read-playback-state',\n  userReadCurrentlyPlaying: 'user-read-currently-playing',\n  userModifyPlaybackState: 'user-modify-playback-state',\n\n  // playlists\n  playlistReadCollaborative: 'playlist-read-collaborative',\n  playlistModifyPrivate: 'playlist-modify-private',\n  playlistModifyPublic: 'playlist-modify-public',\n  playlistReadPrivate: 'playlist-read-private',\n\n  // playback\n  streaming: 'streaming',\n  appRemoteControl: 'app-remote-control',\n\n  // users\n  userReadEmail: 'user-read-email',\n  userReadPrivate: 'user-read-private'\n}\n\nexport const allScopes = (() => {\n  return Object.keys(scopes)\n    .reduce((sum, scope) => {\n      return sum.concat(scopes[scope], '%20')\n    }, '')\n    .slice(0, -3)\n})()\n\nexport default scopes\n","const getRedirectUrl = (clientID, scopes, redirectUri, showDialog) => {\r\n  return (\r\n    'https://accounts.spotify.com/authorize?response_type=token' +\r\n    `&client_id=${clientID}` +\r\n    `&scope=${scopes.join('%20')}` +\r\n    `&redirect_uri=${redirectUri}` +\r\n    '&show_dialog=' +\r\n    Boolean(showDialog)\r\n  )\r\n}\r\n\r\nexport default getRedirectUrl\r\n","import React from 'react'\nimport styles from './SpotifyAuth.css'\nimport t from 'prop-types'\n\nconst SpotifyLogo = (props) => {\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 496 512'\n      className={props.className || styles.rsaSpotifyLogo}\n    >\n      <path d='M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z' />\n    </svg>\n  )\n}\n\nSpotifyLogo.propTypes = {\n  className: t.string\n}\n\nexport default SpotifyLogo\n","export const getHash = () => {\r\n  return window\r\n    ? window.parent.location.hash\r\n        .substring(1)\r\n        .split('&')\r\n        .reduce((initial, item) => {\r\n          if (item) {\r\n            const parts = item.split('=')\r\n            initial[parts[0]] = decodeURIComponent(parts[1])\r\n          }\r\n          return initial\r\n        }, {})\r\n    : ''\r\n}\r\n","/**\r\n * @class SpotifyAuth\r\n */\r\n\r\nimport React, { Component } from 'react'\r\nimport scopes from './Scopes'\r\nimport getRedirectUri from './generateUrl'\r\n\r\nimport styles from './SpotifyAuth.css'\r\nimport t from 'prop-types'\r\nimport SpotifyLogo from './SpotifyLogo'\r\nimport { getHash } from './getHash'\r\n\r\nclass SpotifyAuth extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      isAuthenticatedWithSpotify: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const accessToken = getHash().access_token\r\n\r\n    if (accessToken) {\r\n      if (!this.props.noCookie) {\r\n        document.cookie = `spotifyAuthToken=${accessToken}; max-age=${60 * 60};`\r\n      }\r\n      if (this.props.localStorage) {\r\n        window.localStorage.setItem('spotifyAuthToken', accessToken)\r\n      }\r\n      this.props.onAccessToken(accessToken)\r\n    }\r\n  }\r\n\r\n  handleClick = (event) => {\r\n    event.preventDefault()\r\n\r\n    window.location = getRedirectUri(\r\n      this.props.clientID,\r\n      this.props.scopes,\r\n      this.props.redirectUri,\r\n      this.props.showDialog\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button\r\n        className={this.props.btnClassName || styles.rsaSpotifyBtn}\r\n        onClick={(event) => this.handleClick(event)}\r\n      >\r\n        {!this.props.noLogo && (\r\n          <SpotifyLogo className={this.props.logoClassName} />\r\n        )}\r\n        <span>{this.props.title}</span>\r\n      </button>\r\n    )\r\n  }\r\n}\r\n\r\nSpotifyAuth.propTypes = {\r\n  redirectUri: t.string.isRequired,\r\n  clientID: t.string.isRequired,\r\n  scopes: t.arrayOf(t.string),\r\n  onAccessToken: t.func,\r\n  logoClassName: t.string,\r\n  title: t.string,\r\n  noLogo: t.bool,\r\n  noCookie: t.bool,\r\n  showDialog: t.bool,\r\n  localStorage: t.bool\r\n}\r\n\r\nSpotifyAuth.defaultProps = {\r\n  redirectUri: 'http://localhost:3000',\r\n  scopes: [scopes.userReadPrivate, scopes.userReadEmail],\r\n  onAccessToken: (token) => {},\r\n  title: 'Continue with Spotify',\r\n  localStorage: false,\r\n  noLogo: false,\r\n  noCookie: false,\r\n  showDialog: false,\r\n}\r\n\r\nexport default SpotifyAuth\r\n","import { useEffect } from 'react'\n\nimport { getHash } from './getHash'\nimport t from 'prop-types'\n\nconst SpotifyAuthListener = (props) => {\n  useEffect(() => {\n    const accessToken = getHash().access_token\n\n    if (accessToken) {\n      if (!props.noCookie) {\n        document.cookie = `spotifyAuthToken=${accessToken}; max-age=${60 * 60};`\n      }\n      if (props.localStorage) {\n        window.localStorage.setItem('spotifyAuthToken', accessToken)\n      }\n      props.onAccessToken(accessToken)\n    }\n  }, [])\n\n  return null\n}\n\nSpotifyAuthListener.propTypes = {\n  noCookie: t.bool,\n  localStorage: t.bool,\n  onAccessToken: t.func\n}\n\nSpotifyAuthListener.defaultProps = {\n  noCookie: false,\n  localStorage: false,\n  onAccessToken: (token) => {}\n}\n\nexport default SpotifyAuthListener\n","import Scopes, { allScopes } from './Scopes'\nimport SpotifyAuth from './SpotifyAuth'\nimport SpotifyAuthListener from './SpotifyAuthListener'\n\nScopes.all = allScopes\n\nexport { Scopes, SpotifyAuth, SpotifyAuthListener }\n"],"names":["scopes","ugcImageUpload","userFollowRead","userFollowModify","userReadRecentlyPlayed","userTopRead","userReadPlaybackPosition","userLibraryRead","userLibraryModify","userReadPlaybackState","userReadCurrentlyPlaying","userModifyPlaybackState","playlistReadCollaborative","playlistModifyPrivate","playlistModifyPublic","playlistReadPrivate","streaming","appRemoteControl","userReadEmail","userReadPrivate","allScopes","Object","keys","reduce","sum","scope","concat","slice","getRedirectUrl","clientID","redirectUri","showDialog","join","Boolean","SpotifyLogo","props","React","className","styles","rsaSpotifyLogo","propTypes","t","string","getHash","window","parent","location","hash","substring","split","initial","item","parts","decodeURIComponent","SpotifyAuth","handleClick","event","preventDefault","getRedirectUri","state","isAuthenticatedWithSpotify","componentDidMount","accessToken","access_token","noCookie","document","cookie","localStorage","setItem","onAccessToken","render","btnClassName","rsaSpotifyBtn","noLogo","logoClassName","title","Component","isRequired","arrayOf","func","bool","defaultProps","token","SpotifyAuthListener","useEffect","Scopes","all"],"mappings":"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"}