{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport React from 'react';\nimport { serialize } from '../utils';\nimport { SpotifyApiContext, SpotifyApiAxiosContext } from '../';\n\nfunction useApiRequest(url, options = {}) {\n  const _React$useState = React.useState(false),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        loading = _React$useState2[0],\n        setLoading = _React$useState2[1];\n\n  const _React$useState3 = React.useState(null),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        error = _React$useState4[0],\n        setError = _React$useState4[1];\n\n  const _React$useState5 = React.useState(null),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        data = _React$useState6[0],\n        setData = _React$useState6[1];\n\n  const token = React.useContext(SpotifyApiContext);\n  const axios = React.useContext(SpotifyApiAxiosContext);\n  const loadData = React.useCallback(_asyncToGenerator(_regeneratorRuntime.mark(function _callee() {\n    var res, resData;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          setLoading(true);\n          res = null;\n          resData = null;\n\n          if (!axios) {\n            _context.next = 11;\n            break;\n          }\n\n          _context.next = 7;\n          return axios.get(url + serialize(options), {\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 7:\n          res = _context.sent;\n          resData = res.data;\n          _context.next = 17;\n          break;\n\n        case 11:\n          _context.next = 13;\n          return fetch(url + serialize(options), {\n            method: 'GET',\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 13:\n          res = _context.sent;\n          _context.next = 16;\n          return res.json();\n\n        case 16:\n          resData = _context.sent;\n\n        case 17:\n          setLoading(false);\n\n          if (resData.error) {\n            setError(resData.error);\n          } else if (res.status !== 200) {\n            setError({\n              status: res.status,\n              message: res.statusText\n            });\n          } else {\n            setData(resData);\n            setError(null);\n          }\n\n          _context.next = 26;\n          break;\n\n        case 21:\n          _context.prev = 21;\n          _context.t0 = _context[\"catch\"](0);\n          setLoading(false);\n          setError(_context.t0);\n          setData(null);\n\n        case 26:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 21]]);\n  })), [axios, options.ids, options.q, token, url]);\n  React.useEffect(() => {\n    loadData();\n  }, [url, options.ids, options.q, token, loadData]);\n  const loadMoreData = React.useCallback(_asyncToGenerator(_regeneratorRuntime.mark(function _callee2() {\n    var res, resData, limit, offset, wantedOpts;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n\n          if (!(data && data.next && data.items)) {\n            _context2.next = 21;\n            break;\n          }\n\n          setLoading(true);\n          res = null;\n          resData = null;\n          limit = options.limit, offset = options.offset, wantedOpts = _objectWithoutProperties(options, [\"limit\", \"offset\"]);\n\n          if (!axios) {\n            _context2.next = 13;\n            break;\n          }\n\n          _context2.next = 9;\n          return axios.get(data.next + serialize(wantedOpts, true), {\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 9:\n          res = _context2.sent;\n          resData = res.data;\n          _context2.next = 19;\n          break;\n\n        case 13:\n          _context2.next = 15;\n          return fetch(data.next + serialize(wantedOpts, true), {\n            method: 'GET',\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 15:\n          res = _context2.sent;\n          _context2.next = 18;\n          return res.json();\n\n        case 18:\n          resData = _context2.sent;\n\n        case 19:\n          setLoading(false);\n\n          if (resData.error) {\n            setError(resData.error);\n          } else if (res.status !== 200) {\n            setError({\n              status: res.status,\n              message: res.statusText\n            });\n          } else {\n            setData(_objectSpread({}, resData, {\n              items: data.items.concat(resData.items)\n            }));\n            setError(null);\n          }\n\n        case 21:\n          _context2.next = 28;\n          break;\n\n        case 23:\n          _context2.prev = 23;\n          _context2.t0 = _context2[\"catch\"](0);\n          setLoading(false);\n          setError(_context2.t0);\n          setData(null);\n\n        case 28:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[0, 23]]);\n  })), [axios, options.ids, options.q, url, token, data]);\n  return {\n    data,\n    loading,\n    error,\n    loadMoreData\n  };\n}\n\nexport default useApiRequest;","map":{"version":3,"sources":["/Users/nmargalit/node_modules/react-spotify-api/dist/ApiRequest/useApiRequest.js"],"names":["_defineProperty","_objectWithoutProperties","_regeneratorRuntime","_asyncToGenerator","_slicedToArray","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","React","serialize","SpotifyApiContext","SpotifyApiAxiosContext","useApiRequest","url","options","_React$useState","useState","_React$useState2","loading","setLoading","_React$useState3","_React$useState4","error","setError","_React$useState5","_React$useState6","data","setData","token","useContext","axios","loadData","useCallback","mark","_callee","res","resData","wrap","_callee$","_context","prev","next","get","headers","Authorization","concat","sent","fetch","method","json","status","message","statusText","t0","stop","ids","q","useEffect","loadMoreData","_callee2","limit","offset","wantedOpts","_callee2$","_context2","items"],"mappings":"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","sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { serialize } from '../utils';\nimport { SpotifyApiContext, SpotifyApiAxiosContext } from '../';\n\nfunction useApiRequest(url, options = {}) {\n  const _React$useState = React.useState(false),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        loading = _React$useState2[0],\n        setLoading = _React$useState2[1];\n\n  const _React$useState3 = React.useState(null),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        error = _React$useState4[0],\n        setError = _React$useState4[1];\n\n  const _React$useState5 = React.useState(null),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        data = _React$useState6[0],\n        setData = _React$useState6[1];\n\n  const token = React.useContext(SpotifyApiContext);\n  const axios = React.useContext(SpotifyApiAxiosContext);\n  const loadData = React.useCallback(_asyncToGenerator(_regeneratorRuntime.mark(function _callee() {\n    var res, resData;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          setLoading(true);\n          res = null;\n          resData = null;\n\n          if (!axios) {\n            _context.next = 11;\n            break;\n          }\n\n          _context.next = 7;\n          return axios.get(url + serialize(options), {\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 7:\n          res = _context.sent;\n          resData = res.data;\n          _context.next = 17;\n          break;\n\n        case 11:\n          _context.next = 13;\n          return fetch(url + serialize(options), {\n            method: 'GET',\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 13:\n          res = _context.sent;\n          _context.next = 16;\n          return res.json();\n\n        case 16:\n          resData = _context.sent;\n\n        case 17:\n          setLoading(false);\n\n          if (resData.error) {\n            setError(resData.error);\n          } else if (res.status !== 200) {\n            setError({\n              status: res.status,\n              message: res.statusText\n            });\n          } else {\n            setData(resData);\n            setError(null);\n          }\n\n          _context.next = 26;\n          break;\n\n        case 21:\n          _context.prev = 21;\n          _context.t0 = _context[\"catch\"](0);\n          setLoading(false);\n          setError(_context.t0);\n          setData(null);\n\n        case 26:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 21]]);\n  })), [axios, options.ids, options.q, token, url]);\n  React.useEffect(() => {\n    loadData();\n  }, [url, options.ids, options.q, token, loadData]);\n  const loadMoreData = React.useCallback(_asyncToGenerator(_regeneratorRuntime.mark(function _callee2() {\n    var res, resData, limit, offset, wantedOpts;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n\n          if (!(data && data.next && data.items)) {\n            _context2.next = 21;\n            break;\n          }\n\n          setLoading(true);\n          res = null;\n          resData = null;\n          limit = options.limit, offset = options.offset, wantedOpts = _objectWithoutProperties(options, [\"limit\", \"offset\"]);\n\n          if (!axios) {\n            _context2.next = 13;\n            break;\n          }\n\n          _context2.next = 9;\n          return axios.get(data.next + serialize(wantedOpts, true), {\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 9:\n          res = _context2.sent;\n          resData = res.data;\n          _context2.next = 19;\n          break;\n\n        case 13:\n          _context2.next = 15;\n          return fetch(data.next + serialize(wantedOpts, true), {\n            method: 'GET',\n            headers: {\n              Authorization: \"Bearer \".concat(token)\n            }\n          });\n\n        case 15:\n          res = _context2.sent;\n          _context2.next = 18;\n          return res.json();\n\n        case 18:\n          resData = _context2.sent;\n\n        case 19:\n          setLoading(false);\n\n          if (resData.error) {\n            setError(resData.error);\n          } else if (res.status !== 200) {\n            setError({\n              status: res.status,\n              message: res.statusText\n            });\n          } else {\n            setData(_objectSpread({}, resData, {\n              items: data.items.concat(resData.items)\n            }));\n            setError(null);\n          }\n\n        case 21:\n          _context2.next = 28;\n          break;\n\n        case 23:\n          _context2.prev = 23;\n          _context2.t0 = _context2[\"catch\"](0);\n          setLoading(false);\n          setError(_context2.t0);\n          setData(null);\n\n        case 28:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[0, 23]]);\n  })), [axios, options.ids, options.q, url, token, data]);\n  return {\n    data,\n    loading,\n    error,\n    loadMoreData\n  };\n}\n\nexport default useApiRequest;"]},"metadata":{},"sourceType":"module"}